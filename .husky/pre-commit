#!/usr/bin/env sh
. "$(dirname "$0")/_/husky.sh"

echo "Running pre-commit quality gate..."

# Run quality gate in fast mode (format, lint, typecheck, secrets, LOC check)
# Tests are skipped by default for speed, but can be enabled with RUN_UNIT_TESTS=1

if [ "$RUN_UNIT_TESTS" = "1" ]; then
  echo "Running full quality gate with tests..."
  npx --no-install --no bash scripts/quality-gate.sh --fix || exit $?
else
  echo "Running fast quality gate (format, lint, typecheck, secrets)..."
  npx --no-install --no bash scripts/quality-gate.sh --fast --fix || exit $?
fi

echo "Pre-commit quality gate passed âœ…"
